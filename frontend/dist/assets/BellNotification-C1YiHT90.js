import{r as s,U as k,u as y,j as t,L as b,J as E,c as f}from"./index-DuESt0g0.js";const D="/assets/bell-C4Es8X0D.mp3",T="/assets/bellGold-E1OEtZ8G.png",p="https://ees121.com",S=()=>{const{user:h}=s.useContext(k),c=JSON.parse(localStorage.getItem("token")),a=y(),[i,d]=s.useState([]),[r,u]=s.useState(!1),n=s.useRef(null),m=s.useCallback(()=>{new Audio(D).play().catch(o=>{console.error("Error playing sound:",o)})},[]),w=()=>{u(!r)},g=()=>{m(),w(),r?n.current&&clearTimeout(n.current):n.current=setTimeout(()=>{u(!1)},5e3)},x=async()=>{if(h)try{const e=await f.get(`${p}/request/getNotifications`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},withCredentials:!0});console.log(e.data.notifications,"notify"),d(e.data.notifications)}catch(e){console.error("Error fetching notifications:",e)}},N=async e=>{try{await f.delete(`${p}/request/deleteNotification`,{data:{notificationId:e},headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},withCredentials:!0}),d(o=>o.filter(l=>l._id!==e).sort((l,C)=>new Date(C.timestamp)-new Date(l.timestamp)))}catch(o){console.error("Error deleting notification:",o)}},j=e=>{e.title.toLowerCase()==="new work"?a("/work"):e.title.toLowerCase()==="new joining"?a("/team"):e.title.toLowerCase()==="rewards"&&a("/wallet")};return s.useEffect(()=>(x(),()=>{n.current&&clearTimeout(n.current)}),[]),t.jsxs("div",{className:"bell-notification-container",children:[t.jsxs(b,{onClick:g,title:"Notifications","aria-label":"Notifications",className:"notification-bell-link",children:[t.jsx("img",{src:T,height:50,width:40,alt:"Notification Bell"}),i.length>0&&t.jsx("span",{className:"notification-count",children:i.length})]}),r&&t.jsx("div",{className:"notification-dropdown",children:i.length===0?t.jsx("p",{children:"No notifications"}):t.jsx("ul",{children:i.map(e=>t.jsxs("li",{className:"notification-item w-100 d-flex justify-content-between text-sm cursor-pointer",onClick:()=>j(e),children:[t.jsxs("div",{children:[t.jsx("strong",{children:e.title}),": ",e.message]}),t.jsx("div",{children:t.jsx(E,{className:"delete-icon",onClick:o=>{o.stopPropagation(),N(e._id)}})})]},e._id))})})]})};export{S as default};
