import{r as l,j as e,c as v,B as f,M as A,P as E,d as P,W as L,U as R,u as U,A as $,e as O,f as z,g as D,h as T,L as W,i as _,k as Y}from"./index-CBkbb6rS.js";import{s as S,a as k}from"./startSilver-5oWuoMuE.js";import{C as J}from"./CurrentLocation-SIizAIWP.js";const M="https://ees121.com",G=()=>{const[s,x]=l.useState(null),[p,h]=l.useState(null),o=JSON.parse(localStorage.getItem("token")),[d,i]=l.useState(!1),g=c=>{const a=c.target.files[0];x(a),h(URL.createObjectURL(a))},r=async c=>{if(c.preventDefault(),!s){alert("Please upload an image");return}const a=new FormData;a.append("banner",s),console.log("FormData:",Object.fromEntries(a));try{i(!0);const t=await v.post(`${M}/banner/addBanner`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}});f("Banner Added Successfully"),window.location.reload(),x(null),h(null)}catch(t){console.error("Error details:",t),f(t.response.data.message)}finally{i(!1)}};return e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:r,children:e.jsxs("div",{className:"",children:[e.jsx("label",{htmlFor:"file-upload",className:"h-[100px] btn d-inline-block border border-orange d-flex justify-content-center align-items-center  text-center ",children:"Add Offer Benner"}),e.jsx("input",{type:"file",id:"file-upload",name:"banner",onChange:g}),p&&e.jsx("img",{src:p,alt:"Preview",width:"200"}),e.jsx("button",{type:"submit",className:"btn bg-green p-0 p-1 text-white mt-1",disabled:d,children:d?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):"Add"})]})})})},I="https://ees121.com",V=()=>{const[s,x]=l.useState([]),[p,h]=l.useState(null),o=JSON.parse(localStorage.getItem("token")),[d,i]=l.useState(!1);if(!o)return e.jsx("div",{children:"You must be logged in to view banners."});const g=async()=>{i(!0);try{const a=await v.get(`${I}/banner/getBanners`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(a.status===200){const t=a.data;x(t.banners)}}catch(a){h("Error fetching banners. Please try again later."),console.error("Error fetching banners:",a)}finally{i(!1)}},r=async a=>{f.info(e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this Banner?"}),e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>c(a),children:"Yes"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:f.dismiss,children:"No"})]})]}),{autoClose:!0,closeOnClick:!0})},c=async a=>{f.dismiss();try{(await v.delete(`${I}/banner/deleteBanner`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},data:{bannerId:a}})).status===200&&(console.log("Banner deleted successfully"),g())}catch(t){h("Error deleting banner. Please try again later."),console.error("Error deleting banner:",t)}finally{i(!1)}};return l.useEffect(()=>{g()},[]),e.jsx("section",{className:"mt-3",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[p&&e.jsx("div",{className:"alert alert-danger",children:p}),s.length>0?s.map((a,t)=>e.jsx("div",{className:"col-md-4 p-1",children:e.jsxs("div",{className:"card card-banners h-100 w-100 overflow-hidden",children:[e.jsx("div",{className:"img-banner",style:{height:"100%"},children:e.jsx("img",{src:a.imageUrl,className:"card-img-top overflow-hidden img-fluid",style:{objectFit:"cover",height:"100%"},alt:a.description||"Banner"})}),e.jsx("div",{className:"banner-Btn",children:e.jsx("button",{className:"btn bg-orange text-white fs-4 p-0 p-1",onClick:()=>r(a._id),disabled:d,children:d?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):e.jsx(A,{})})})]})},t)):e.jsx("div",{children:"No banners available."})]})})})})},q="https://ees121.com",H=({user:s})=>{const x=JSON.parse(localStorage.getItem("token")),[p,h]=l.useState(null),[o,d]=l.useState(null),[i,g]=l.useState(!1),[r,c]=l.useState(null),[a,t]=l.useState(!1),n=l.useRef(null),b=async u=>{var N,C;const m=new FormData;m.append("profilePic",u),t(!0);try{const j=await v.post(`${q}/auth/updateProfile`,m,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${x}`}}),F=await j.data;console.log(F.message,"Image uploaded"),j.status===200&&f("Profile Updated Successfully")}catch(j){console.error("Error uploading image:",j),f((C=(N=j==null?void 0:j.response)==null?void 0:N.data)==null?void 0:C.message)}finally{t(!1)}},y=async u=>{const m=u.target.files[0];if(m){if(m.size>2*1024*1024){f.error("File size should be less than 2MB."),setTimeout(()=>window.location.reload(),3e3);return}const N=URL.createObjectURL(m);h(m),d(N),await b(m)}},B=async()=>{const u=n.current.getScreenshot();c(u),g(!1),d(u);const m=await(await fetch(u)).blob();await b(m)},w=()=>{g(u=>!u)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"position-absolute overflow-hidden  w-[150px] h-[150px] top-[120px] start-[50px] ring-green ring-offset-base-100 w-32 rounded-full ring ring-offset-2",children:e.jsx("label",{htmlFor:"profilePictureInput",className:`rounded-md cursor-pointer z-90 ${i?"disabled":""}`,style:{width:"150px",height:"150px",objectFit:"cover",objectPosition:"center"},children:e.jsx("img",{src:o||s.profilePic||E,alt:"Profile",className:"rounded-md img-fluid w-100 h-100"})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"",name:"profilePic",id:"profilePictureInput",disabled:i}),e.jsx("button",{type:"button",onClick:w,className:"position-absolute top-60 start-36 p-2 bg-orange text-white rounded-full mx-2",children:e.jsx(P,{})}),e.jsxs("div",{className:"d-flex d-md-none",children:[e.jsx("label",{htmlFor:"cameraInput",className:"position-absolute top-60 start-36 p-2 bg-orange text-white rounded-full mx-2 cursor-pointer",children:e.jsx(P,{})}),e.jsx("input",{type:"file",accept:"image/*",capture:"camera",id:"cameraInput",onChange:y,className:"hidden"})]}),i&&e.jsx("div",{className:"webcam-overlay d-none d-md-flex",children:e.jsxs("div",{className:"webcam-popup",children:[e.jsx(L,{audio:!1,ref:n,screenshotFormat:"image/jpeg",className:"webcam"}),e.jsx("button",{type:"button",onClick:B,className:"btn btn-primary mt-2",children:"Capture"}),e.jsx("button",{type:"button",onClick:w,className:"btn btn-secondary mt-2",children:"Close"})]})})]})},Z=()=>{const{user:s}=l.useContext(R),[x,p]=l.useState(!1),h=U(),o=`https://ees121.com/register?referralCode=${s==null?void 0:s._id}`,d=()=>{navigator.clipboard.writeText(o),p(!0),setTimeout(()=>p(!1),2e3)},i=(r=[],c=10)=>{const a=r.length>0?r.reduce((n,b)=>n+b,0)/r.length:0,t=[];for(let n=1;n<=c;n++)t.push(e.jsx("img",{src:n<=a?S:k,alt:n<=a?"Filled Star":"Empty Star",width:15},n));return t},g=(r=[],c=10)=>{const a=r.length>0?r.reduce((n,b)=>n+b,0)/r.length:0,t=[];for(let n=1;n<=c;n++)t.push(e.jsx("img",{src:n<=a?S:k,alt:n<=a?"Filled Star":"Empty Star",width:15},n));return t};return e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(O,{}),e.jsx(z,{}),e.jsxs("div",{className:"my-24",children:[e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card rounded-md overflow-hidden border-0 bg-base-100 shadow-xl",children:[e.jsxs("div",{className:"w-full position-relative bg-orange flex items-center justify-center",children:[e.jsx("img",{className:"h-[200px] w-full",src:"https://img.freepik.com/free-vector/colorful-watercolor-texture-background_1035-19319.jpg?ga=GA1.1.897959581.1731651336&semt=ais_hybrid",alt:"profile"}),e.jsx("div",{className:"avatar",children:e.jsx(H,{user:s})})]}),e.jsx("div",{children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[e.jsxs("div",{className:"col-12 col-md-5 p-5",children:[e.jsx("div",{className:"pt-5 text-orange",children:s.profilePic?e.jsx(e.Fragment,{}):e.jsx("p",{children:" You haven't set a profile picture yet."})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"rating rating-sm d-flex flex-column text-start",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{className:"text-sm",children:"User :"}),(s==null?void 0:s.userRatings)&&e.jsxs("div",{className:"flex items-center",children:[g(s==null?void 0:s.userRatings.map(r=>r.rating),10),e.jsxs("span",{className:"pl-2",children:[s==null?void 0:s.userAverageRating,".0"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{className:"text-sm",children:"Provider :"}),(s==null?void 0:s.providerRatings)&&e.jsxs("div",{className:"flex items-center",children:[i(s==null?void 0:s.providerRatings.map(r=>r.rating),10),e.jsxs("span",{className:"pl-2",children:[s==null?void 0:s.providerAverageRating,".0"]})]})]})]}),e.jsxs("h6",{className:"py-3",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Email :"})," ",e.jsx("span",{className:"text-gray-800 font-semibold",children:s==null?void 0:s.email})]}),e.jsxs("p",{className:"pb-3",children:[" ",e.jsx("span",{className:"text-gray-600 font-medium",children:"Phone :"})," ",e.jsxs("span",{className:"text-gray-800 font-semibold",children:["+91",s==null?void 0:s.phone]})]}),e.jsx(J,{user:s}),e.jsx("div",{className:"flex",children:e.jsx("button",{onClick:()=>h("/editprofile",{state:s}),className:"text-orange py-3 rounded-full font-semibold uppercase text-sm",children:"Edit Profile"})})]}),e.jsx("div",{className:"col-12 col-md-6 d-flex justify-content-md-end justify-content-start",children:e.jsxs("div",{className:"p-5 w-full",children:[e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Your Referral Link:"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 px-4 py-2 my-2 rounded-md w-full sm:w-auto",children:[e.jsx("span",{className:"text-blue-600 font-medium truncate",children:o}),e.jsx("button",{onClick:d,className:"text-gray-500 hover:text-blue-500",children:x?e.jsx(D,{size:20}):e.jsx(T,{size:20})}),e.jsx(W,{to:`whatsapp://send?text=${o}`,className:"text-white bg-orange text-sm p-2 rounded-md flex items-center",children:e.jsx(_,{size:16})})]}),x&&e.jsx("p",{className:"text-green-500 text-sm",children:"Copied!"})]}),(s==null?void 0:s.userId)&&e.jsx("div",{className:"pt-3",children:e.jsxs("p",{className:"text-gray-600 font-medium",children:["Unique Id : ",e.jsxs("span",{className:"text-gray-800 font-semibold",children:[" EES121-",s==null?void 0:s.userId]})]})}),e.jsxs("p",{className:"text-gray py-3",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Business Category : "}),e.jsx("span",{className:"text-gray-800 font-semibold",children:s==null?void 0:s.businessCategory})]}),e.jsx("div",{className:"pt-4",children:e.jsx(G,{})})]})})]})})]})})})})}),e.jsx(V,{})]}),e.jsx(Y,{})]})};export{Z as default};
