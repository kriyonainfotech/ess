import{r as l,j as e,c as v,B as j,M as A,P as L,d as S,W as E,U as R,u as U,A as $,e as O,f as D,L as T,g as W,h as _}from"./index-CI4TOCPE.js";import{s as C,a as k}from"./startSilver-5oWuoMuE.js";import{C as z}from"./CurrentLocation-CxsQzRMl.js";const Y="https://ees121.com",J=()=>{const[s,u]=l.useState(null),[m,p]=l.useState(null),o=JSON.parse(localStorage.getItem("token")),[d,i]=l.useState(!1),x=c=>{const t=c.target.files[0];u(t),p(URL.createObjectURL(t))},r=async c=>{if(c.preventDefault(),!s){alert("Please upload an image");return}const t=new FormData;t.append("banner",s),console.log("FormData:",Object.fromEntries(t));try{i(!0);const a=await v.post(`${Y}/banner/addBanner`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}});j("Banner Added Successfully"),window.location.reload(),u(null),p(null)}catch(a){console.error("Error details:",a),j(a.response.data.message)}finally{i(!1)}};return e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:r,children:e.jsxs("div",{className:"",children:[e.jsx("label",{htmlFor:"file-upload",className:"h-[100px] btn d-inline-block border border-orange d-flex justify-content-center align-items-center  text-center ",children:"Add Offer Benner"}),e.jsx("input",{type:"file",id:"file-upload",name:"banner",onChange:x}),m&&e.jsx("img",{src:m,alt:"Preview",width:"200"}),e.jsx("button",{type:"submit",className:"btn bg-green p-0 p-1 text-white mt-1",disabled:d,children:d?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):"Add"})]})})})},I="https://ees121.com",G=()=>{const[s,u]=l.useState([]),[m,p]=l.useState(null),o=JSON.parse(localStorage.getItem("token")),[d,i]=l.useState(!1);if(!o)return e.jsx("div",{children:"You must be logged in to view banners."});const x=async()=>{i(!0);try{const t=await v.get(`${I}/banner/getBanners`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(t.status===200){const a=t.data;u(a.banners)}}catch(t){p("Error fetching banners. Please try again later."),console.error("Error fetching banners:",t)}finally{i(!1)}},r=async t=>{j.info(e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this Banner?"}),e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>c(t),children:"Yes"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:j.dismiss,children:"No"})]})]}),{autoClose:!0,closeOnClick:!0})},c=async t=>{j.dismiss();try{(await v.delete(`${I}/banner/deleteBanner`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},data:{bannerId:t}})).status===200&&(console.log("Banner deleted successfully"),x())}catch(a){p("Error deleting banner. Please try again later."),console.error("Error deleting banner:",a)}finally{i(!1)}};return l.useEffect(()=>{x()},[]),e.jsx("section",{className:"mt-3",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[m&&e.jsx("div",{className:"alert alert-danger",children:m}),s.length>0?s.map((t,a)=>e.jsx("div",{className:"col-md-4 p-1",children:e.jsxs("div",{className:"card card-banners h-100 w-100 overflow-hidden",children:[e.jsx("div",{className:"img-banner",style:{height:"100%"},children:e.jsx("img",{src:t.imageUrl,className:"card-img-top overflow-hidden img-fluid",style:{objectFit:"cover",height:"100%"},alt:t.description||"Banner"})}),e.jsx("div",{className:"banner-Btn",children:e.jsx("button",{className:"btn bg-orange text-white fs-4 p-0 p-1",onClick:()=>r(t._id),disabled:d,children:d?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):e.jsx(A,{})})})]})},a)):e.jsx("div",{children:"No banners available."})]})})})})},M="https://ees121.com",V=({user:s})=>{const u=JSON.parse(localStorage.getItem("token")),[m,p]=l.useState(null),[o,d]=l.useState(null),[i,x]=l.useState(!1),[r,c]=l.useState(null),[t,a]=l.useState(!1),n=l.useRef(null),b=async h=>{var N,P;const g=new FormData;g.append("profilePic",h),a(!0);try{const f=await v.post(`${M}/auth/updateProfile`,g,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${u}`}}),F=await f.data;console.log(F.message,"Image uploaded"),f.status===200&&(window.location.reload(),j("Profile Updated Successfully"))}catch(f){console.error("Error uploading image:",f),j((P=(N=f==null?void 0:f.response)==null?void 0:N.data)==null?void 0:P.message)}finally{a(!1)}},y=async h=>{const g=h.target.files[0];if(g){const N=URL.createObjectURL(g);p(g),d(N),await b(g)}},B=async()=>{const h=n.current.getScreenshot();c(h),x(!1),d(h);const g=await(await fetch(h)).blob();await b(g)},w=()=>{x(h=>!h)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"position-absolute overflow-hidden  w-[150px] h-[150px] top-[120px] start-[50px] ring-green ring-offset-base-100 w-32 rounded-full ring ring-offset-2",children:e.jsx("label",{htmlFor:"profilePictureInput",className:`rounded-md cursor-pointer z-90 ${i?"disabled":""}`,style:{width:"150px",height:"150px",objectFit:"cover",objectPosition:"center"},children:e.jsx("img",{src:o||s.profilePic||L,alt:"Profile",className:"rounded-md img-fluid w-100 h-100"})})}),e.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"",name:"profilePic",id:"profilePictureInput",disabled:i}),e.jsx("button",{type:"button",onClick:w,className:"position-absolute top-60 start-36 p-2 bg-orange text-white rounded-full mx-2",children:e.jsx(S,{})}),e.jsxs("div",{className:"d-flex d-md-none",children:[e.jsx("label",{htmlFor:"cameraInput",className:"position-absolute top-60 start-36 p-2 bg-orange text-white rounded-full mx-2 cursor-pointer",children:e.jsx(S,{})}),e.jsx("input",{type:"file",accept:"image/*",capture:"camera",id:"cameraInput",onChange:y,className:"hidden"})]}),i&&e.jsx("div",{className:"webcam-overlay d-none d-md-flex",children:e.jsxs("div",{className:"webcam-popup",children:[e.jsx(E,{audio:!1,ref:n,screenshotFormat:"image/jpeg",className:"webcam"}),e.jsx("button",{type:"button",onClick:B,className:"btn btn-primary mt-2",children:"Capture"}),e.jsx("button",{type:"button",onClick:w,className:"btn btn-secondary mt-2",children:"Close"})]})})]})},Q=()=>{const{user:s}=l.useContext(R),[u,m]=l.useState(!1),p=U(),o=`https://ees121.com/register?referralCode=${s==null?void 0:s.phone}`,d=()=>{navigator.clipboard.writeText(o),m(!0),setTimeout(()=>m(!1),2e3)},i=(r=[],c=10)=>{const t=r.length>0?r.reduce((n,b)=>n+b,0)/r.length:0,a=[];for(let n=1;n<=c;n++)a.push(e.jsx("img",{src:n<=t?C:k,alt:n<=t?"Filled Star":"Empty Star",width:15},n));return a},x=(r=[],c=10)=>{const t=r.length>0?r.reduce((n,b)=>n+b,0)/r.length:0,a=[];for(let n=1;n<=c;n++)a.push(e.jsx("img",{src:n<=t?C:k,alt:n<=t?"Filled Star":"Empty Star",width:15},n));return a};return e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(O,{}),e.jsx(D,{}),e.jsxs("div",{className:"my-24",children:[e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card rounded-md overflow-hidden border-0 bg-base-100 shadow-xl",children:[e.jsxs("div",{className:"w-full position-relative bg-orange flex items-center justify-center",children:[e.jsx("img",{className:"h-[200px] w-full",src:"https://img.freepik.com/free-vector/colorful-watercolor-texture-background_1035-19319.jpg?ga=GA1.1.897959581.1731651336&semt=ais_hybrid",alt:"profile"}),e.jsx("div",{className:"avatar",children:e.jsx(V,{user:s})})]}),e.jsx("div",{children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[e.jsxs("div",{className:"col-12 col-md-6 p-5",children:[e.jsx("div",{className:"pt-5 text-orange",children:s.profilePic?e.jsx(e.Fragment,{}):e.jsx("p",{children:" You haven't set a profile picture yet."})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-700",children:s==null?void 0:s.name}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"rating rating-sm d-flex flex-column text-start",children:[e.jsx("strong",{className:"text-sm",children:"User :"}),e.jsx("div",{children:s!=null&&s.userRatings?e.jsxs("div",{className:" d-flex align-items-center",children:[x(s==null?void 0:s.userRatings.map(r=>r.rating),10),e.jsx("span",{className:"ps-2 ",children:s==null?void 0:s.userAverageRating})]}):e.jsx(e.Fragment,{})})]}),e.jsxs("div",{className:"rating rating-sm d-flex flex-column  text-start",children:[e.jsx("strong",{className:"text-sm",children:"Provider :"}),e.jsx("div",{children:s!=null&&s.providerRatings?e.jsxs("div",{className:" d-flex align-items-center",children:[i(s==null?void 0:s.providerRatings.map(r=>r.rating),10),e.jsx("span",{className:"ps-2 ",children:s==null?void 0:s.providerAverageRating})]}):e.jsx(e.Fragment,{})})]})]}),e.jsx("h6",{className:"py-3 text-gray",children:s==null?void 0:s.email}),e.jsxs("p",{className:"text-gray pb-3",children:[" +91",s==null?void 0:s.phone]}),e.jsx(z,{user:s}),e.jsx("div",{className:"flex",children:e.jsx("button",{onClick:()=>p("/editprofile",{state:s}),className:"text-orange py-3 rounded-full font-semibold uppercase text-sm",children:"Edit Profile"})})]}),e.jsx("div",{className:"col-12 col-md-6 d-flex justify-content-md-end justify-content-start",children:e.jsxs("div",{className:"p-5 w-full",children:[e.jsx("p",{className:"text-gray",children:"Your Referral Link :"}),e.jsx("p",{onClick:d,className:"text-blue-500 cursor-pointer",children:o}),u&&e.jsx("p",{className:"text-green-500",children:"Link copied!"}),e.jsx(T,{to:`whatsapp://send?text=${o}`,className:" bg-blue text-white p-0 text-sm p-1 rounded-1",children:"Share"}),(s==null?void 0:s.userId)&&e.jsx("div",{className:"pt-3",children:e.jsxs("p",{className:"text-gray",children:["Unique Id : ",e.jsxs("strong",{children:["EES121-",s==null?void 0:s.userId]})]})}),e.jsxs("h6",{className:"text-gray py-3",children:["Business Category ",e.jsx(W,{className:"inline-block"})]}),(s==null?void 0:s.businessCategory)&&e.jsx("div",{className:"btn d-flex justify-content-center text-uppercase rounded-md text-white bg-orange py-2",children:s.businessCategory}),e.jsx("div",{className:"pt-4",children:e.jsx(J,{})})]})})]})})]})})})})}),e.jsx(G,{})]}),e.jsx(_,{})]})};export{Q as default};
