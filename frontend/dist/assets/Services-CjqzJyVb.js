import{u as p,r as t,c as v,B as N,j as e,A as y,e as b,f as w,h as S}from"./index-BJcydSwj.js";import{$ as C}from"./module-CdoXl0JJ.js";import F from"./SearchBox-CCN6vSu-.js";const A="https://ess-eta.vercel.app",$=()=>{const i=p();JSON.parse(localStorage.getItem("token"));const[l,x]=t.useState([]),[o,g]=t.useState(!1),[m,f]=t.useState(1),[c,u]=t.useState(!0),n=t.useRef(),h=t.useCallback(async()=>{var s,r;if(!(!c||o)){g(!0);try{const a=await v.get(`${A}/category/getAllCategory?page=${m}&limit=20`);if(console.log(a,"category response"),!a.data||!Array.isArray(a.data.category))throw new Error("Invalid data format: 'category' is missing or not an array");a.data.category.length===0?u(!1):(x(d=>[...d,...a.data.category]),f(d=>d+1))}catch(a){console.error("Error fetching categories:",a),N(((r=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to fetch categories")}finally{g(!1)}}},[m,c,o]);t.useEffect(()=>{h()},[]);const j=t.useCallback(s=>{o||(n.current&&n.current.disconnect(),n.current=new IntersectionObserver(r=>{r[0].isIntersecting&&c&&h()}),s&&n.current.observe(s))},[o,c]);return e.jsx("section",{children:e.jsxs("div",{className:"container bd-orange",children:[e.jsx("div",{className:"row row-cols-3 row-cols-lg-5 overflow-hidden",children:l.map((s,r)=>e.jsx("div",{className:"col",style:{cursor:"pointer"},onClick:()=>i("/serviceDetail",{state:s.categoryName}),ref:r===l.length-1?j:null,children:e.jsxs("div",{className:"border-0 w-100 h-100 text-center items-center rounded-md",children:[e.jsx("figure",{className:"w-full m-0 p-2",children:e.jsx("img",{className:"img-fluid w-100 border-orange rounded-4 p-1 overflow-hidden",style:{objectFit:"cover"},src:s.image,alt:s.categoryName})}),e.jsx("h6",{className:"text-md text-capitalize",children:s.categoryName})]})},s.categoryName))}),o&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"10vh"},children:e.jsx(C,{color:"#00BFFF",height:50,width:50})})]})})},B=()=>{const[i,l]=t.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(b,{}),e.jsx(w,{}),e.jsxs("div",{className:"my-32",children:[e.jsx("section",{children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12 d-lg-none pb-3",children:e.jsx(F,{})})})})}),i?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):e.jsx($,{})]}),e.jsx(S,{})]})};export{B as default};
