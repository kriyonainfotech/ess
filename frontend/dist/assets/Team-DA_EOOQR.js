import{r as a,U as j,j as e,c as m,L as x,A as u,e as p,f as g,k as N}from"./index-D3TCWhIX.js";const v="https://ees121.com",y=()=>{const{user:s}=a.useContext(j),[n,f]=a.useState([]),[h,d]=a.useState({direct:0,total:0}),[o,c]=a.useState(!0),[i,t]=a.useState("");return a.useEffect(()=>{(async()=>{if(!(s!=null&&s._id)){t("User is not authenticated"),c(!1);return}try{const r=await m.get(`${v}/referal/getreferrals/${s._id}`);console.log(r.data,"Referral Data"),f(r.data.referredUsers),d(r.data.user.referralCounts),c(!1)}catch{t("Error fetching data"),c(!1)}})()},[s==null?void 0:s._id]),e.jsxs("div",{className:"mt-2",children:[i&&e.jsx("div",{className:"alert alert-danger",children:i}),e.jsx("div",{className:"text-start",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"d-flex justify-content-between",children:e.jsx("div",{children:e.jsx("h4",{className:"",children:"Your Referrals"})})}),o?e.jsxs("div",{children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{children:"Loading referrals..."})]}):e.jsx("div",{className:"list-group",children:n.length>0?n.map((l,r)=>e.jsxs("div",{className:"alert alert-success",children:[e.jsx("h5",{children:l.name}),e.jsx("p",{children:l.phone}),e.jsxs("p",{children:[e.jsx("strong",{children:"Referrals:"})," ",l.referrals.length]})]},r)):e.jsx("div",{className:"alert alert-warning",children:"No referrals found."})})]})})]})},R="https://ees121.com",S=()=>{const{user:s}=a.useContext(j),[n,f]=a.useState([]),[h,d]=a.useState(!0),[o,c]=a.useState(null);return a.useEffect(()=>{(async()=>{var t,l;if(s!=null&&s._id){d(!0);try{const r=await m.get(`${R}/referal/getReferredBy/${s._id}`);r.status===200?(f(r.data.referredBy),console.log(r.data,"referdby")):c("Failed to fetch referrals")}catch(r){console.error("Error fetching referrals:",r),c(((l=(t=r.response)==null?void 0:t.data)==null?void 0:l.message)||"Something went wrong")}finally{d(!1)}}})()},[s==null?void 0:s._id]),h?e.jsx("p",{children:"Loading referrals..."}):o?e.jsxs("p",{children:["Error: ",o]}):e.jsxs("div",{className:"text-start",children:[e.jsx("h4",{className:"py-2",children:"ReferredBy"}),e.jsx("div",{className:"col-md-12",children:e.jsx("div",{children:e.jsx(x,{to:`tel:${n.phone}`,className:"list-group",children:n.length>0?n.map((i,t)=>e.jsxs("div",{className:"alert alert-primary",children:[e.jsx("h5",{children:i.name}),e.jsx("p",{children:e.jsx(x,{children:i.phone})})]},t)):e.jsx("div",{className:"alert alert-primary",children:"No referrals found."})})})})]})},w=()=>(a.useState("referral"),e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsx(p,{}),e.jsx(g,{}),e.jsx("div",{className:"py-28",children:e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"raffral w-100",children:[e.jsx(S,{}),e.jsx(y,{})]})})})})}),e.jsx(N,{})]}));export{w as default};
