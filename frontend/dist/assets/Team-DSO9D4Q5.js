import{r,U as p,j as e,L as u,c as g,A as S,d as R,P as w,h as C}from"./index-CDisOkul.js";const E="https://ees121.com",L=()=>{const{user:s}=r.useContext(p),[o,f]=r.useState([]),[h,c]=r.useState(!0),[m,x]=r.useState(null);return r.useEffect(()=>{(async()=>{var n,i;if(s!=null&&s._id){c(!0);try{const a=await g.get(`${E}/referal/getReferredBy/${s._id}`);a.status===200?(f(a.data.referredBy),console.log(a.data,"referdby")):x("Failed to fetch referredby")}catch(a){console.error("Error fetching referredby:",a),x(((i=(n=a.response)==null?void 0:n.data)==null?void 0:i.message)||"Something went wrong")}finally{c(!1)}}})()},[s==null?void 0:s._id]),h?e.jsx("p",{children:"Loading referredby..."}):m?e.jsxs("p",{children:["Error: ",m]}):e.jsxs("div",{className:"text-start mt-4",children:[e.jsx("p",{className:"text-lg lg:text-2xl font-semibold pb-2",children:"ReferredBy"}),e.jsx("div",{className:"col-md-12",children:e.jsx("div",{children:e.jsx(u,{className:"list-group",children:o.length>0?o.map((d,n)=>e.jsxs("div",{className:"alert alert-primary",children:[e.jsx("h5",{children:d.name}),e.jsx("p",{children:e.jsx(u,{children:d.phone})})]},n)):e.jsx("div",{className:"alert alert-primary",children:"No Referrer found."})})})})]})},_="https://ees121.com",U=()=>{const{user:s}=r.useContext(p),[o,f]=r.useState([]),[h,c]=r.useState([]),[m,x]=r.useState({direct:0,total:0}),[d,n]=r.useState(!0),[i,a]=r.useState(""),[N,y]=r.useState("");r.useEffect(()=>{(async()=>{if(!(s!=null&&s._id)){a("User is not authenticated"),n(!1);return}try{const t=await g.get(`${_}/referal/getreferrals/${s._id}`);console.log(t.data,"Referral Data"),f(t.data.referredUsers),x(t.data.user.referralCounts),n(!1),c(t.data.referredUsers)}catch{a("Error fetching data"),n(!1)}})()},[s==null?void 0:s._id]);const v=l=>{const t=l.target.value.toLowerCase();y(t);const b=o.filter(j=>j.name.toLowerCase().includes(t)||j.phone.includes(t));c(b)};return e.jsxs("div",{className:"mt-2",children:[i&&e.jsx("div",{className:"alert alert-danger",children:i}),e.jsxs("div",{className:"text-start",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-end pb-2",children:[e.jsx("div",{children:e.jsx("p",{className:"text-lg lg:text-2xl font-semibold",children:"Your Referrals"})}),e.jsx("div",{className:"search-container",children:e.jsx("input",{type:"text",value:N,onChange:v,placeholder:"Search by name or phone",className:"form-control custom-search-input"})})]}),d?e.jsxs("div",{children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{children:"Loading referrals..."})]}):e.jsx("div",{className:"list-group",children:h.length>0?h.map((l,t)=>e.jsx("div",{className:"alert alert-success p-4 rounded-lg shadow-md mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"",children:[e.jsx("strong",{children:"User Name:"})," ",l.name]}),e.jsx("p",{children:e.jsxs("a",{href:`tel:${l.phone}`,className:"text-md text-blue-600 hover:underline",children:[e.jsx("strong",{children:"Call: "}),l.phone]})})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Referrals:"})," ",l.referrals.length]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Verified:"})," ",l.paymentVerified?"✅ Yes":"❌ No"]})]})]})},t)):e.jsx("div",{className:"alert alert-warning text-center p-4 rounded-lg",children:"No referrals found."})})]})]})},B=()=>(r.useState("referral"),e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsx(R,{}),e.jsx(w,{}),e.jsx("div",{className:"py-28",children:e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"raffral w-100",children:[e.jsx(L,{}),e.jsx(U,{})]})})})})}),e.jsx(C,{})]}));export{B as default};
