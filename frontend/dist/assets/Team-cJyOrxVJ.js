import{r as a,U as m,j as e,c as j,L as h,A as u,e as p,f as g,k as N}from"./index-042nz8j6.js";const v="https://ees121.com",y=()=>{const{user:s}=a.useContext(m),[n,f]=a.useState([]),[x,d]=a.useState({direct:0,total:0}),[o,c]=a.useState(!0),[i,l]=a.useState("");return a.useEffect(()=>{(async()=>{if(!(s!=null&&s._id)){l("User is not authenticated"),c(!1);return}try{const r=await j.get(`${v}/referal/getreferrals/${s._id}`);console.log(r.data,"Referral Data"),f(r.data.referredUsers),d(r.data.user.referralCounts),c(!1)}catch{l("Error fetching data"),c(!1)}})()},[s==null?void 0:s._id]),e.jsxs("div",{className:"mt-2",children:[i&&e.jsx("div",{className:"alert alert-danger",children:i}),e.jsx("div",{className:"text-start",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"d-flex justify-content-between",children:e.jsx("div",{children:e.jsx("h4",{className:"",children:"Your Referrals"})})}),o?e.jsxs("div",{children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{children:"Loading referrals..."})]}):e.jsx("div",{className:"list-group",children:n.length>0?n.map((t,r)=>e.jsx("div",{className:"alert alert-success p-4 rounded-lg shadow-md",children:e.jsxs("div",{className:"flex flex-wrap sm:flex-col justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("h5",{className:"text-lg font-semibold",children:["User Name: ",t.name]}),e.jsxs("a",{href:`tel:${t.phone}`,className:"text-md font-bold text-blue-600 hover:underline",children:["ðŸ“ž Call: ",t.phone]})]}),e.jsxs("div",{className:"flex flex-col sm:items-start",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Referrals:"})," ",t.referrals.length]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Verified:"})," ",t.paymentVerified?"âœ… Yes":"âŒ No"]})]})]})},r)):e.jsx("div",{className:"alert alert-warning text-center p-4 rounded-lg",children:"No referrals found."})})]})})]})},R="https://ees121.com",b=()=>{const{user:s}=a.useContext(m),[n,f]=a.useState([]),[x,d]=a.useState(!0),[o,c]=a.useState(null);return a.useEffect(()=>{(async()=>{var l,t;if(s!=null&&s._id){d(!0);try{const r=await j.get(`${R}/referal/getReferredBy/${s._id}`);r.status===200?(f(r.data.referredBy),console.log(r.data,"referdby")):c("Failed to fetch referrals")}catch(r){console.error("Error fetching referrals:",r),c(((t=(l=r.response)==null?void 0:l.data)==null?void 0:t.message)||"Something went wrong")}finally{d(!1)}}})()},[s==null?void 0:s._id]),x?e.jsx("p",{children:"Loading referrals..."}):o?e.jsxs("p",{children:["Error: ",o]}):e.jsxs("div",{className:"text-start",children:[e.jsx("h4",{className:"py-2",children:"ReferredBy"}),e.jsx("div",{className:"col-md-12",children:e.jsx("div",{children:e.jsx(h,{to:`tel:${n.phone}`,className:"list-group",children:n.length>0?n.map((i,l)=>e.jsxs("div",{className:"alert alert-primary",children:[e.jsx("h5",{children:i.name}),e.jsx("p",{children:e.jsx(h,{children:i.phone})})]},l)):e.jsx("div",{className:"alert alert-primary",children:"No referrals found."})})})})]})},S=()=>(a.useState("referral"),e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsx(p,{}),e.jsx(g,{}),e.jsx("div",{className:"py-28",children:e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"raffral w-100",children:[e.jsx(b,{}),e.jsx(y,{})]})})})})}),e.jsx(N,{})]}));export{S as default};
